<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interview Dashboard</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    min-height:100vh;
    overflow-x:hidden;
}

/* Glass Card */
.glass-card{
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(15px);
    border-radius:20px;
    padding:25px;
    color:white;
    box-shadow:0 8px 32px rgba(0,0,0,0.3);
    transition:0.4s ease;
}

.glass-card:hover{
    transform:translateY(-5px);
}

.section-title{
    font-weight:600;
    margin-bottom:20px;
}

/* Countdown Circle */
.circle{
    width:160px;
    height:160px;
    border-radius:50%;
    background:conic-gradient(#00f2fe var(--percent),rgba(255,255,255,0.2) 0%);
    display:flex;
    align-items:center;
    justify-content:center;
    margin:auto;
    transition:1s ease;
}

.circle-inner{
    width:130px;
    height:130px;
    background:#1c2b36;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    color:white;
}

/* Fade Animation */
.fade-in{
    animation:fadeIn 1.2s ease forwards;
}

@keyframes fadeIn{
    from{opacity:0; transform:translateY(20px);}
    to{opacity:1; transform:translateY(0);}
}
</style>
</head>
<body>

<div class="container py-5">

    <h2 class="text-center text-white mb-5 fade-in">
        Fresher Interview Dashboard
    </h2>

    <div class="row g-4">

        <!-- Fresher Details -->
        <div class="col-md-4 fade-in">
            <div class="glass-card">
                <h5 class="section-title">üë§ Fresher Details</h5>
                <p><strong>Name:</strong> <span id="userName">Loading...</span></p>
                <p><strong>Email:</strong> <span id="userEmail">Loading...</span></p>
                <p><strong>Training Start:</strong> <span id="trainingStart">-</span></p>
                <p><strong>Training End:</strong> <span id="trainingEnd">-</span></p>
            </div>
        </div>

        <!-- Countdown -->
        <div class="col-md-4 fade-in">
            <div class="glass-card text-center">
                <h5 class="section-title">‚è≥ Training Completion</h5>
                <div class="circle" id="progressCircle" style="--percent:0%;">
                    <div class="circle-inner">
                        <h3 id="daysRemaining">0</h3>
                        <small>Days Left</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Details -->
        <div class="col-md-4 fade-in">
            <div class="glass-card">
                <h5 class="section-title">üõ† Admin Details</h5>
                <p><strong>Name:</strong> <span id="adminName">Loading...</span></p>
                <p><strong>Email:</strong> <span id="adminEmail">Loading...</span></p>
                <p><strong>Department:</strong> <span id="adminDept">Loading...</span></p>
            </div>
        </div>

    </div>
</div>

<!-- Firebase SDK -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDPe0Zp69bnM9251w0FfnH1UPhGedGh4qo",
  authDomain: "novus-9dfb8.firebaseapp.com",
  projectId: "novus-9dfb8",
  storageBucket: "novus-9dfb8.appspot.com",
  messagingSenderId: "641276518161",
  appId: "1:641276518161:web:ee2c11e2662e86e59bb6b0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Check Login
onAuthStateChanged(auth, async (user) => {

    if(user){

        // Fetch Fresher Data
        const userRef = doc(db,"users",user.uid);
        const userSnap = await getDoc(userRef);

        if(userSnap.exists()){
            const data = userSnap.data();

            document.getElementById("userName").innerText = data.name;
            document.getElementById("userEmail").innerText = data.email;
            document.getElementById("trainingStart").innerText = data.trainingStart;
            document.getElementById("trainingEnd").innerText = data.trainingEnd;

            calculateDays(data.trainingStart, data.trainingEnd);
        }

        // Fetch Admin (Assuming single admin doc named admin1)
        const adminRef = doc(db,"admins","admin1");
        const adminSnap = await getDoc(adminRef);

        if(adminSnap.exists()){
            const admin = adminSnap.data();
            document.getElementById("adminName").innerText = admin.name;
            document.getElementById("adminEmail").innerText = admin.email;
            document.getElementById("adminDept").innerText = admin.department;
        }

    }else{
        alert("Please login first!");
        window.location.href="login.html";
    }

});

// Countdown Logic
function calculateDays(startDate,endDate){

    const end = new Date(endDate);
    const today = new Date();

    const diffTime = end - today;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

    document.getElementById("daysRemaining").innerText = diffDays;

    const totalDuration = (new Date(endDate) - new Date(startDate)) / (1000*60*60*24);
    const completed = totalDuration - diffDays;

    const percent = (completed/totalDuration)*100;
    document.getElementById("progressCircle").style.setProperty("--percent", percent + "%");
}

</script>

</body>

</html>
