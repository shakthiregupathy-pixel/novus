<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mavericks Fresher Reporting</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

/* ================= BODY ================= */
body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg,#E9B9F9,#75B5F9);
    min-height: 100vh;
}

/* ================= HEADER ================= */
.header-bar {
    background: #312F45;
    color: white;
    padding: 20px;
    text-align: center;
    font-weight: 600;
    font-size: 22px;
    letter-spacing: 1px;
}

/* ================= CARD DESIGN ================= */
.card-custom {
    background: white;
    border-radius: 20px;
    padding: 25px;
    box-shadow: 0 20px 40px rgba(49,47,69,0.2);
    margin-bottom: 25px;
}

/* ================= INPUT STYLE ================= */
.form-control {
    border-radius: 12px;
    padding: 10px;
}

label {
    font-weight: 500;
    margin-bottom: 5px;
}

/* ================= BUTTONS ================= */
.btn-generate {
    background: linear-gradient(135deg,#75B5F9,#C57DE7);
    color: white;
    border-radius: 25px;
    padding: 8px 20px;
    border: none;
}

.btn-download {
    background: linear-gradient(135deg,#84fab0,#8fd3f4);
    border-radius: 25px;
    padding: 8px 20px;
    font-weight: 600;
    border: none;
}

.btn-success {
    border-radius: 25px;
    padding: 8px 20px;
}

/* ================= SUMMARY ================= */
.summary-box p {
    font-size: 16px;
    margin-bottom: 8px;
}

.summary-box span {
    font-weight: bold;
    color: #312F45;
}

</style>
</head>

<body>

<div class="header-bar">
    Mavericks Freshers Reporting Dashboard
</div>

<div class="container mt-5">

<!-- Candidate Details -->
<div class="card-custom">
<h5 class="mb-3">Candidate Details</h5>

<div class="row">
<div class="col-md-4">
<label>Name</label>
<input type="text" id="name" class="form-control" readonly>
</div>

<div class="col-md-4">
<label>Employee ID</label>
<input type="text" id="empid" class="form-control" readonly>
</div>

<div class="col-md-4">
<label>Department</label>
<input type="text" id="dept" class="form-control" readonly>
</div>
</div>

<div class="row mt-3">
<div class="col-md-4">
<label>Role</label>
<input type="text" id="role" class="form-control" readonly>
</div>

<div class="col-md-4">
<label>Training Phase</label>
<input type="text" id="phase" class="form-control" readonly>
</div>

<div class="col-md-4">
<label>Certifications</label>
<input type="text" id="certs" class="form-control" readonly>
</div>
</div>
</div>

<!-- Assessment -->
<div class="card-custom">
<h5 class="mb-3">Assessment Scores</h5>

<div class="row">
<div class="col-md-4">
<label>Quiz Score (%)</label>
<input type="number" id="quiz" class="form-control">
</div>

<div class="col-md-4">
<label>Coding Score (%)</label>
<input type="number" id="coding" class="form-control">
</div>

<div class="col-md-4">
<label>Assignment Score (%)</label>
<input type="number" id="assignment" class="form-control">
</div>
</div>

<button class="btn btn-generate mt-3" onclick="generateReport()">Generate Performance</button>
<button class="btn btn-success mt-3" onclick="generateCertificate()">Generate Certificate</button>
</div>

<!-- Summary -->
<div class="card-custom summary-box">
<h5>Performance Summary</h5>

<p>Overall Performance: <span id="overall">-</span></p>
<p>Skill Level: <span id="skill">-</span></p>

<h6 class="mt-3">Recruitment Feedback</h6>
<p id="feedback">-</p>

<button class="btn btn-download mt-3" onclick="downloadPDF()">Download PDF Report</button>
</div>

</div>

<!-- ================= FIREBASE SCRIPT ================= -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDPe0Zp69bnM9251w0FfnH1UPhGedGh4qo",
  authDomain: "novus-9dfb8.firebaseapp.com",
  projectId: "novus-9dfb8",
  storageBucket: "novus-9dfb8.firebasestorage.app",
  messagingSenderId: "641276518161",
  appId: "1:641276518161:web:ee2c11e2662e86e59bb6b0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let overallScore = 0;
let feedbackText = "";
let skillLevel = "";

/* AUTO LOAD USER */
onAuthStateChanged(auth, async (user) => {

if (!user) {
    window.location.href = "index.html";
    return;
}

const docSnap = await getDoc(doc(db, "users", user.uid));

if (docSnap.exists()) {
    const data = docSnap.data();

    name.value = data.name || "";
    empid.value = data.employeeId || "";
    dept.value = data.department || "";
    role.value = data.role || "";
    phase.value = data.phase || "";
    certs.value = data.certs || "";
}

});

/* PERFORMANCE */
window.generateReport = function() {

let quiz = parseFloat(document.getElementById("quiz").value) || 0;
let coding = parseFloat(document.getElementById("coding").value) || 0;
let assignment = parseFloat(document.getElementById("assignment").value) || 0;

overallScore = (quiz + coding + assignment) / 3;

overall.innerText = overallScore.toFixed(2) + "%";

if (overallScore >= 85) {
    skillLevel = "Advanced";
    feedbackText = "Highly recommended for recruitment.";
}
else if (overallScore >= 60) {
    skillLevel = "Intermediate";
    feedbackText = "Recommended with improvement areas.";
}
else {
    skillLevel = "Beginner";
    feedbackText = "Needs additional training.";
}

skill.innerText = skillLevel;
feedback.innerText = feedbackText;

}

/* PDF REPORT */
window.downloadPDF = function() {

const { jsPDF } = window.jspdf;
const pdf = new jsPDF();

pdf.setFontSize(18);
pdf.text("MAVERICKS TRAINING REPORT", 105, 20, null, null, "center");

pdf.save("Training_Report.pdf");

}

/* CERTIFICATE */
window.generateCertificate = function() {

const { jsPDF } = window.jspdf;
const pdf = new jsPDF("landscape");

const name = document.getElementById("name").value || "Candidate";

pdf.setFontSize(30);
pdf.text(name, 148, 110, null, null, "center");

pdf.save(name + "_Certificate.pdf");

}

</script>

</body>
</html>
